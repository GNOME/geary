# Makefile.in
#
# Copyright 2016 Software Freedom Conservancy Inc.

BUILD_DIR := build
BINARIES := geary geary-console geary-mailer

BUILD_BINARIES := $(addprefix $(BUILD_DIR)/,$(BINARIES))

.PHONY: all
all:
	@$(MAKE) -C $(BUILD_DIR)
	@cp $(BUILD_BINARIES) .

.PHONY: install
install:
	@$(MAKE) -C $(BUILD_DIR) $@

.PHONY: uninstall
uninstall:
	@$(MAKE) -C $(BUILD_DIR) $@
	@$(MAKE) -C $(BUILD_DIR) post-uninstall

.PHONY: pot_file
pot_file:
	@$(MAKE) -C $(BUILD_DIR) $@
	@cp build/po/geary.pot po

.PHONY: clean
clean:
	@-$(MAKE) -C $(BUILD_DIR) clean
	@-rm -f $(BINARIES)
	@-rm -f .stamp

.PHONY: distclean
distclean: clean
	@-rm -rf $(BUILD_DIR)
	@-rm -f Makefile

.PHONY: tests
tests:
	@$(MAKE) -C $(BUILD_DIR) $@

.PHONY: test
test:
	@$(MAKE) -C $(BUILD_DIR) tests

.PHONY: test-engine
test-engine:
	@$(MAKE) -C $(BUILD_DIR) $@-run

.PHONY: test-client
test-client:
	@$(MAKE) -C $(BUILD_DIR) $@-run

.PHONY: dist
dist: tests
	@$(MAKE) -C $(BUILD_DIR) dist
	@cp build/*.xz .

.PHONY: ubuntu
ubuntu: test
	@$(MAKE) -C $(BUILD_DIR) ubuntu

.PHONY: valadoc
valadoc:
	@$(MAKE) -C $(BUILD_DIR) valadoc
